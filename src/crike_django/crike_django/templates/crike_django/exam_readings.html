{% extends 'crike_django/lesson_base.html' %}
{% load staticfiles %}

{% block subcontent %}
<script>
  $('.step-links').hide();

  $(function(){
    var form = $('#ExamForm');
    $('#counter').countdown({
       image: "{% static 'countdown/img/digits.png' %}",
       startTime: '10:00',
       timerEnd: function(){ 
        $('#popup')
        .html("<label style='font-size:300%'>时间到.. <i style='color:orange' class='fa fa-frown-o'/></label>")
        .show()
        $('#overlay').show()
        setTimeout( function () { $(form).submit(); }, 1000);
       },
       format: 'mm:ss'
    });
  });

  function onSubmit(e) {

    var form = $('#ExamForm');
    var pickcheck = $(form).find( "input:radio:checked" ).length;

    if ( pickcheck < 5) //TODO assume that comprehension has 5 questions
    {
      e.preventDefault();
      var showtimer = null;
      var cb = "$('#popup').hide();$('#overlay').hide()"
      $('#popup')
      .html("<label style='font-size:250%'><i style='color:red' class='fa fa-minus-square'></i> 还没做完呢，又粗心了吧 <i style='color:orange' class='fa fa-frown-o'/></label>")
      .show()
      $('#overlay').show()
      shotimer = setTimeout(cb, 2000)
      return false;
    }
  };
  function onPick(me) {
    $(me).find("input:radio").prop('checked',true);
  }
</script>

<div id='overlay'></div>
<div id='popup'></div>

<form id='ExamForm' action='/reading/{{id}}/' method='post'>
  <div class='jumbotron subject-header-container2'>
    <label>{{name}}</label>
    <div id="counter" style='float:right;'></div>
    <p>Read this article within 10 minutes, and answer the questions bellow</p>
    {% csrf_token %}
    <input type="submit" onClick='onSubmit(event);' value="submit" class="btn btn-primary btn-lg" style="margin-right:20px;margin-bottom:10px;">
    <strong id='feedback'>Choose the best answer</strong>
  </div>

  <p>Article: </p>
  <div class="col-12 col-sm-12 col-lg-12">
    <div class="thumbnail">
      <p><b id="text_reading_name">{{reading.name}}</b></p>
      <p class="autogrow_article">{{reading.article}}</p>
    </div>
  </div>
  {% for ques in reading.questions %}
  <p>Question{{forloop.counter}}: </p>
  <div id='question1'>
    <div class="col-12 col-sm-12 col-lg-12">
      <div class="thumbnail">
        <p class="autogrow_question">{{ques.question}}</p>
      </div>
    </div>
    <div class="col-6 col-sm-6 col-lg-3" onclick="onPick(this);">
      <input type="radio" name="answer{{forloop.counter}}" value=1>
      <div class="thumbnail">A<p id="choice_1" class="autogrow_choice">{{ques.answers.0}}</p></div>
    </div>
    <div class="col-6 col-sm-6 col-lg-3" onclick="onPick(this);">
      <input type="radio" name="answer{{forloop.counter}}" value=2>
      <div class="thumbnail">B<p id="choice_2" class="autogrow_choice">{{ques.answers.1}}</p></div>
    </div>
    <div class="col-6 col-sm-6 col-lg-3" onclick="onPick(this);">
      <input type="radio" name="answer{{forloop.counter}}" value=3>
      <div class="thumbnail">C<p id="choice_3" class="autogrow_choice">{{ques.answers.2}}</p></div>
    </div>
    <div class="col-6 col-sm-6 col-lg-3" onclick="onPick(this);">
      <input type="radio" name="answer{{forloop.counter}}" value=4>
      <div class="thumbnail">D<p id="choice_4" class="autogrow_choice">{{ques.answers.3}}</p></div>
    </div>
  </div>
  {% endfor %}
</form>

{% block body_footer %}
<script src="{% static 'countdown/js/jquery.countdown.js' %}" type="text/javascript" charset="utf-8"></script>
{% endblock %}

{% endblock %}

